<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>경력 증명서</title>
    <style>
        body {
            text-align: center;
            font-family: 'Arial', sans-serif;
            margin: 20px;
            position: relative;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        .container {
            max-width: 570px;
            height: 800px;
            margin: 0 auto;
            border: 1px solid #ddd;
            position: relative;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .content {
            margin-bottom: 40px;
        }
        .signature {
            text-align: center;
            margin-top: auto;
            position: absolute;
            bottom: 0;
            width: 100%;
            font-size: 30px;
        }
        #item {
            width: 100px;
        }
        #contexttable {
            border: 1px solid #ddd;
        }
        .certificateid {
            text-align: left;
            margin-left: 10px;
            margin-bottom: 20px;
        }
        .blank {
            height: 50px;
        }
        #downloadimage {
			margin-top: 30px;
            width: 40px;
            height: 40px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>경력 증명서</h1>
        </div>
		<div class="certificateid">제 <span th:text="${certificate.certificateId}"></span> 호</div>

        <div class="content">
            <table>
                <tr>
                    <td id="item">성명</td>
                    <td th:text="${certificate.empName}"></td>
                </tr>
                <tr>
                    <td id="item">직책</td>
                    <td th:text="${certificate.position}"></td>
                </tr>
                <tr>
                    <td>회사명</td>
                    <td>Metanet</td>
                </tr>
                <tr>
                    <td>경력사항</td>
                    <td>
                        <p>2022년 7월 1일부터 개발부 근무(1년 04개월)</p>
                        <p>2023년 11월 1일 사직</p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="context">
            <p>위 사람은 상기와 같이 근무하였음을 증명합니다.</p>
        </div>
        <div class="signature">
            <p th:text="${certificate.regDate}"></p>
        </div>
        <div class="blank"></div>
    </div>
    <div th:if="${download == null}" onclick="downloadbuttonTapped('78aebdb2-b7a4-4f82-b262-53c1ad54f121')">
        <img id="downloadimage" src="https://github.com/kyh0113/metanet_team2_final/assets/76652929/00dd73f4-b994-484a-88a8-a9b449d9be04" alt="">
    </div>

    <script>
        function downloadbuttonTapped(ceritificateId) {

            var url = '/certificate/download/generate?certificate_id='+ceritificateId

			// AJAX 요청 생성
			var xhr = new XMLHttpRequest();
			xhr.open('GET', url, true);
			// 요청 완료 시 실행될 함수 설정
			xhr.onreadystatechange = function () {
			    if (xhr.readyState == 4 && xhr.status == 200) {
			        // 성공적으로 요청이 완료되었을 때 실행할 코드
			        alert('요청이 성공적으로 접수되었습니다.\n접수 번호 : ' + xhr.responseText);
			    }
			};
			
			// JSON 데이터를 문자열로 변환하여 요청 전송
			xhr.send();
        }
    </script>
</body>
</html>
